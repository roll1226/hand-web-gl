<!doctype html><html lang="ja"><head><meta charset="UTF-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>手を動かしてグラデションを動かすやーつ</title><script src="https://unpkg.com/three@0.139.2/build/three.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script><script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"></script><script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script><link href="./css/vendor.0ac0cdb4a15a8a96468c.css" rel="stylesheet"><link href="./css/index.3bdf9da146d97daf0dbb.css" rel="stylesheet"></head><body><div class="modal" data-show="true"><div class="modal__card"><button class="modal__card__btn modal__card__btn--normal">モーションキャプチャーなし</button> <button class="modal__card__btn modal__card__btn--hand">モーションキャプチャーあり</button> <span>※「モーションキャプチャーあり」の場合、カメラが起動します</span></div></div><canvas id="webgl-canvas"></canvas><div class="container"><video id="input"></video><canvas id="output" width="300" height="200"></canvas></div><script>const modal=document.querySelector(".modal");let isHand=!1;document.querySelector(".modal__card__btn--normal").addEventListener("click",(()=>{modal.dataset.show="false"})),document.querySelector(".modal__card__btn--hand").addEventListener("click",(()=>{modal.dataset.show="false",camera.start(),isHand=!0}));const video=document.getElementById("input"),canvas=document.getElementById("output"),ctx=canvas.getContext("2d"),config={locateFile:e=>`https://cdn.jsdelivr.net/npm/@mediapipe/hands/${e}`},hands=new Hands(config),camera=new Camera(video,{onFrame:async()=>{await hands.send({image:video})},width:600,height:400});hands.setOptions({maxNumHands:2,modelComplexity:1,minDetectionConfidence:.5,minTrackingConfidence:.5});let codeX=0,codeY=0;hands.onResults((e=>{ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(e.image,0,0,canvas.width,canvas.height),e.multiHandLandmarks&&e.multiHandLandmarks.forEach((e=>{drawConnectors(ctx,e,HAND_CONNECTIONS,{color:"#0f0"}),drawLandmarks(ctx,e,{color:"#f00"}),console.log(e),e.forEach((e=>{codeX+=(e.x-e.y)%e.z}))}))}))</script><script id="js-vertex-shader" type="x-shader/x-vertex">attribute vec3 position;
      attribute vec2 uv;
      varying vec2 vUv;

      void main()	{
        vUv = uv;
        gl_Position = vec4(position, 1.0);
      }</script><script id="js-fragment-shader" type="x-shader/x-fragment">precision mediump float;
      uniform float time;
      varying vec2 vUv;
      void main() {
        vec2 p = vUv * 1.0 - 0.5;
        float r = 1.0 + 0.5 * (sin(5.0 * p.x + time));
        float g = 1.0 + 0.5 * (sin(5.0 * p.y) + sin(time + 2.0 * p.x));
        float b = 1.0 + 0.5 * (sin(5.0 + p.x * p.y * 17.0) + sin(time * 0.4  + 4.0 * p.y));
        gl_FragColor = vec4(r, g, b, 1.0);
      }</script><script>class Stage{constructor(){this.renderParam={width:window.innerWidth,height:window.innerHeight},this.cameraParam={left:-1,right:1,top:1,bottom:-1,near:0,far:-1},this.scene=null,this.camera=null,this.renderer=null,this.geometry=null,this.material=null,this.mesh=null,this.isInitialized=!1}init(){this._setScene(),this._setRender(),this._setCamera(),this.isInitialized=!0}_setScene(){this.scene=new THREE.Scene}_setRender(){this.renderer=new THREE.WebGLRenderer({canvas:document.getElementById("webgl-canvas")}),this.renderer.setSize(this.renderParam.width,this.renderParam.height)}_setCamera(){this.isInitialized||(this.camera=new THREE.OrthographicCamera(this.cameraParam.left,this.cameraParam.right,this.cameraParam.top,this.cameraParam.bottom,this.cameraParam.near,this.cameraParam.far));const e=window.innerWidth,t=window.innerHeight;this.camera.aspect=e/t,this.camera.updateProjectionMatrix(),this.renderer.setSize(e,t)}_render(){this.renderer.render(this.scene,this.camera)}onResize(){this._setCamera()}onRaf(){this._render()}}class Mesh{constructor(e){this.geometryParm={},this.materialParam={useWireframe:!1},this.uniforms={time:{type:"f",value:1}},this.stage=e,this.mesh=null,this.windowWidth=0,this.windowHeight=0,this.windowWidthHalf=0,this.windowHeightHalf=0}init(){this._setMesh()}_setMesh(){const e=new THREE.PlaneBufferGeometry(2,2),t=new THREE.RawShaderMaterial({vertexShader:document.getElementById("js-vertex-shader").textContent,fragmentShader:document.getElementById("js-fragment-shader").textContent,uniforms:this.uniforms});this.mesh=new THREE.Mesh(e,t),this.stage.scene.add(this.mesh)}_render(){isHand?this.uniforms.time.value=codeX:this.uniforms.time.value+=.05}onRaf(){this._render()}}(()=>{const e=new Stage;e.init();const t=new Mesh(e);t.init(),window.addEventListener("resize",(()=>{e.onResize()}));const i=()=>{window.requestAnimationFrame((()=>{e.onRaf(),t.onRaf(),i()}))};i()})()</script><script defer="defer" src="./js/index.3bdf9da146d97daf0dbb.js"></script></body></html>